/*
 IOptimize 2015-09-28 
*/
var venueImageIcons=["",{},{}],VenueItem=function(a,b){var c=this;c.lat=a.lat,c["long"]=a["long"],c.location=ko.computed(function(){return 0===c.lat||0===c.lon?null:new google.maps.LatLng(c.lat,c.lon)}),c.venueName=ko.observable(a.venueName),c.venueDescription=a.venueDescription,c.country=ko.observable(a.country),c.city=ko.observable(a.city),c.province=ko.observable(a.province),c.address=ko.observable(a.address),c.marker=new google.maps.Marker({map:b,draggable:!1,position:new google.maps.LatLng(c.lat,c["long"]),icon:"images/"+a.type+".png"})},venueLocations=[{lat:43.6529,"long":-79.398,venueName:"China Town",venueDescription:"An area in Toronto which happens to have a large amount of asian shops.",country:"CA",city:"Toronto",province:"ON",address:"N/A",type:"Recreation"},{lat:43.655,"long":-79.413,venueName:"Little Italy",venueDescription:"An area in Toronto which has a very large amount of Italian restaurants and businesses.",country:"CA",city:"Toronto",province:"ON",address:"N/A",type:"Recreation"},{lat:43.6617,"long":-79.395,venueName:"University of Toronto",venueDescription:"One of the most academically influential learning instituions in the world.",country:"CA",city:"Toronto",province:"ON",address:"N/A",type:"Education"},{lat:43.7167,"long":-79.3383,venueName:"Ontario Science Centre",venueDescription:"A science museum featuring many different types of technicalogical reserach in the world.",country:"CA",city:"Toronto",province:"ON",address:"N/A",type:"Recreation"},{lat:43.6923,"long":-79.5784,venueName:"Toronto Congress Centre",venueDescription:"A venue which is used as an convention centre which is sitatuted near the airport and many different hotels.",country:"CA",city:"Toronto",province:"ON",address:"N/A",type:"Recreation"},{lat:43.6426,"long":-79.3871,venueName:"CN Tower",venueDescription:"A modern spectacle of the world's engineering and a really tall free-standing structure.",country:"CA",city:"Toronto",province:"ON",address:"N/A",type:"Recreation"},{lat:43.7731,"long":-79.5036,venueName:"York University",venueDescription:"An instituion of Canada which has a large variety of different academic programs, and it is also the only institute in Ontario to have a space engineering program.",country:"CA",city:"Toronto",province:"ON",address:"N/A",type:"Education"}],MyGoogleMaps=function(a,b){var c=[{featureType:"road.highway",elementType:"geometry",stylers:[{saturation:-100},{lightness:-8},{gamma:1.18}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{saturation:-100},{gamma:1},{lightness:-24}]},{featureType:"poi",elementType:"geometry",stylers:[{saturation:-100}]},{featureType:"administrative",stylers:[{saturation:-100}]},{featureType:"transit",stylers:[{saturation:-100}]},{featureType:"water",elementType:"geometry.fill",stylers:[{saturation:-100}]},{featureType:"road",stylers:[{color:"#D0B2B2"}]},{featureType:"administrative",stylers:[{saturation:-100}]},{featureType:"landscape",stylers:[{saturation:-100}]},{featureType:"poi",stylers:[{saturation:-100}]}],d={zoom:11,center:b,mapTypeControlOptions:{mapTypeIds:[google.maps.MapTypeId.ROADMAP,"usroadatlas"]},mapTypeControl:!1,panControl:!1,streetViewControl:!1,zoomControl:!1};map=new google.maps.Map(a,d);var e={},f=new google.maps.StyledMapType(c,e);return map.mapTypes.set("usroadatlas",f),map.setMapTypeId("usroadatlas"),map},ViewModel=function(){function a(){b=MyGoogleMaps(d,e)}var b,c=this,d=$("#map")[0],e=new google.maps.LatLng(43.7,-79.4),f=new google.maps.InfoWindow;this.venues=ko.observableArray([]),this.numVenues=ko.observable(0);var g=[];c.setMarker=function(a){b.panTo(a.marker.position),f.setPosition(a.marker.position),f.setContent(a.venueDescription),f.open(b,a.marker),a.marker.setAnimation(google.maps.Animation.BOUNCE),c.venues().forEach(function(b){a!=b&&b.marker.setAnimation(null)})},c.query=ko.observable(""),c.search=function(){},google.maps.Map.prototype.clearMarkers=function(){for(var a=0;a<g.length;a++)g[a].setMap(null);g=[]},c.filteredVenueList=ko.computed(function(){b&&b.clearMarkers(),console.log(g.length);var a=ko.utils.arrayFilter(c.venues(),function(a){var b=a.venueName().toLowerCase().indexOf(c.query().toLowerCase());return 0>b?!1:!0});return a.forEach(function(a){a.marker.setMap(b),google.maps.event.addListener(a.marker,"click",function(){c.setMarker(a)}),g.push(a.marker),i&&(i.clearMarkers(),i=new MarkerClusterer(b,g,h))}),c.numVenues(a.length),b&&(b.setZoom(11),b.setPosition=e),a}),a(),venueLocations.forEach(function(a){var d=new VenueItem(a,b);c.venues.push(d)}),c.venues().forEach(function(a){a.marker.setMap(b),google.maps.event.addListener(a.marker,"click",function(){c.setMarker(a)}),g.push(a.marker)});var h={gridSize:50,maxZoom:15},i=new MarkerClusterer(b,g,h)};ko.applyBindings(new ViewModel);